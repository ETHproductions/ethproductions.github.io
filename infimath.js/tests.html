<!doctype html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
		<title>infimath.js - Arbitrary-precision math library</title>
		<script src="https://rawgit.com/ETHproductions/infimath.js/master/src/infimath.js" type="text/javascript"></script>
		<link rel="stylesheet" type="text/css" href="../style/style.css">
		<script>
		var testcases = [
		    ["infimath.alignNums",0],
			["Leading zeroes","infimath.alignNums('123','4','56789')+''","00123.,00004.,56789."],
			["Trailing zeroes","infimath.alignNums('.123','.4','.56789')+''",".12300,.40000,.56789"],
			["Zeroes on both ends","infimath.alignNums('123','0.456','7.8')+''","123.000,000.456,007.800"],
			["Big and small numbers","infimath.alignNums('100000000', '.000000001')+''","100000000.000000000,000000000.000000001"],
			["a",1],
		    ["infimath.formatNum",0],
			["Leading zeroes","infimath.formatNum('0001230.0456')","1230.0456"],
			["Trailing zeroes","infimath.formatNum('1230.0456000')","1230.0456"],
			["Leading decimal point","infimath.formatNum('.123')","0.123"],
			["Trailing decimal point","infimath.formatNum('123.')","123"],
			["a",1],
		    ["infimath.exp10",0],
			["No 'e'","infimath.exp10('13.')","13."],
			["'e' with integer","infimath.exp10('1e3')","1000."],
			["'e' with decimal","infimath.exp10('1.2e3')","1200."],
			["'e' with partial decimal","infimath.exp10('1.234e1')","12.34"],
			["'e' with partial negative","infimath.exp10('123.4e-1')","12.34"],
			["'e' with positive","infimath.exp10('1e+3')","1000."],
			["'e' with negative","infimath.exp10('1e-3')",".001"],
			["Separate arguments","infimath.exp10('1','5')","100000."],
			["Separate with decimal","infimath.exp10('1.23','5')","123000."],
			["a",1],
		    ["infimath.add",0],
			["Adding nothing","infimath.add()","0"],
			["Adding one number","infimath.add('1')","1"],
			["Adding two numbers","infimath.add('2', '2.')","4"],
			["Adding many numbers","infimath.add('1', '1', '1', '1', '1', '1', '1.', '1.0', '1.0000')","9"],
			["Adding decimals","infimath.add('1.234','5.6789')","6.9129"],
			["Adding big numbers","infimath.add('1234567890123456789', '3987654321987654321')","5222222212111111110"],
			["Adding many big decimals","infimath.add('120873502934345', '209462432422385.74830385', '998354298.00000000000000000000000', '1.2345678901234567890123456789')","330336933711029.9828717401234567890123456789"],
			["Adding an actual number","infimath.add('1', 2)","3"],
			["Adding two actual numbers","infimath.add(2, 3)","5"],
			["Adding a negative","infimath.add('123', '-45')","78"],
			["Adding two negatives","infimath.add('-12.3', '-4.567')","-20.867"],
			["a",1],
			["String.prototype.plus",0],
			["Adding nothing","'123'.plus()","123"],
			["Adding one number","'123'.plus('45')","168"],
			["Adding many numbers","'123'.plus('1', '2', '3', '4', '5', '6', '7.', '8.0', '9.0000')","168"],
			["Adding decimals","'12.345'.plus('6.7890')","19.134"],
			["Adding big numbers","'1234567890123456789'.plus( '9876543210123456789')","1111111110"],
			["Adding many big decimals","'209462432422385.74830385'.plus( '120873502934345', '998354298.00000000000000000000000', '1.2345678901234567890123456789')","330336933711029.9828717401234567890123456789"],
			["Adding an actual number","'1'.plus(2)","3"],
			["Adding a negative","'123'.plus('-45')","78"],
			["Adding two negatives","'-12.3'.plus('-4.567')","-20.867"],
			["a",1]
		];
		setTimeout(function(){
		var totalSuccess = 0, categories = 0;
		var sectionSuccess = 0, sections = 0;
		var lastIndex = 0;
		var table = document.getElementById("test-table");
		var th, tr, td, code, expected, result;
		toggleTab = function(tabnum) {
			var tabs = document.getElementsByClassName("tab-"+tabnum);
			var arrow = document.getElementById("arrow-"+tabnum);
			if (arrow.innerHTML == "▼") {
				for(var item of tabs) item.style.display = "table-row";
				arrow.innerHTML="▲";
			} else {
				for(var item of tabs) item.style.display = "none";
				arrow.innerHTML="▼";
			}
		}
		testcases.map(function(item,index) {
			lastIndex = index + 1;
			var tr = document.getElementById("test-table").insertRow(index+1);
			if(item[1]===0) {
				th = document.createElement("th");
				th.innerHTML = item[0];
				th.innerHTML += ' <a href="#" id="arrow-'+categories+'" class="arrow" style="background-color:#3E2" onclick="toggleTab('+categories+')">▼</a>'
				tr.appendChild(th);
				return;
			} else if(item[1]===1) {
				categories++;
				totalSuccess += sectionSuccess/sections;
				th = document.createElement("th");
				th.innerHTML = "Section total: "+sectionSuccess+"/"+sections+"<br>&nbsp;";
				tr.appendChild(th);
				sectionSuccess = 0;
				sections = 0;
				return;
			}
			tr.insertCell(0).innerHTML = item[0];
			code = item[1];
			tr.insertCell(1).innerHTML = code;
			expected = item[2];
			tr.insertCell(2).innerHTML = expected;
			result = "ERROR";
			try{result=eval(code)}catch(e){result=e}
			if(result==expected) {
				tr.insertCell(3).innerHTML = '<span style="background-color:#AFA">'+result+'</span>';
				sectionSuccess++;
			} else {
				tr.insertCell(3).innerHTML = '<span style="background-color:#FAA">'+result+'</span>';
			}
			tr.className = "tab-"+categories;
			tr.style.display = "none";
			sections++;
		});
		tr = table.insertRow(lastIndex+1);
		th = document.createElement("th");
		th.innerHTML = 'Total: <span style="background-color:#FF3">'+(totalSuccess/categories*1e2|0)+"%</span>";
		tr.appendChild(th);
		},500);
		</script>
		<style>th,td{overflow-y:scroll;text-align:left;}</style>
	<head>
	<body>
		<p>The formatting will be improved soon.</p>
		<table id="test-table" style="table-layout:fixed;width:90%;padding-left:5%">
			<tr><th style="width:20%">Test</th><th style="width:30%">Code</th><th style="width:25%">Expected</th><th style="width:25%">Real</th></tr>
		</table>
	</body>
</html>