<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
<title>Japt interpreter</title>
<link rel="stylesheet" type="text/css" href="../style/style.css">
<script src="https://rawgit.com/ETHproductions/Japt/master/dependencies/shoco.js"></script>
<script>
  var v="master";
  
  function escapedBtoA(text) {
    return btoa(
      text.replace(/./g,function(x){
        if(x.charCodeAt(0)<256)
          return x;
        return "\\u"+("00"+x.charCodeAt(0).toString(16)).slice(-4)
      })
    );
  }
  
  function escapedAtoB(text) {
    return atob(text).replace(/\\u[0-9A-Fa-f]{4}/g,function(x){return String.fromCharCode(parseInt(x.slice(2),16))});
  }
  
  function splitAddress() {
    var args=location.search.match(/[&?](code|input|v)=([^&]|&(?!(code|input|v)=))*/g);
    var code="[U,V*Wg0 ,Wg1]qS";
    if(args)for(var i of args){
      var tmp=i.slice(i.indexOf('=')+1);
      if(i.slice(1,i.indexOf('='))==="code")
        code=escapedAtoB(tmp);
      else if(i.slice(1,i.indexOf('='))==="input")
        document.getElementById("input").value=escapedAtoB(tmp);
      else
        v=tmp;
    }
    var script = document.createElement('script');
    script.setAttribute("src","https://rawgit.com/ETHproductions/Japt/"+v+"/src/japt-interpreter.js");
    document.getElementsByTagName('head')[0].appendChild(script);
    setTimeout(function(){
    document.getElementById("code").value=code;
    if(typeof transpile!=="undefined")document.getElementById("js-code").value=transpile(code);
    },200);
	for(var a of ["p","h3"])
	  for(var item of document.body.getElementsByTagName(a))
	    item.innerHTML=item.innerHTML.replace(/(`{1,3})((?:.(?!\1))*[^`])\1/g,function(_,_,x){return'<span class="code">'+(x.length>1?x.trimRight():x)+'</span>'});
  }
  
  function getURL() {
    var code = escapedBtoA(document.getElementById("code").value);
    var input = escapedBtoA(document.getElementById("input").value);
    document.getElementById("output").value = "http://ethproductions.github.io/japt?v="+v+"&code="+code+"&input="+input;
  }
  
  function toggleTab(tab) {
    var style=document.getElementById(tab).style;
	if(style.display=="none")style.display="block";else style.display="none";
	var text=document.getElementById("toggle-"+tab);
	if(text.innerHTML=="▼")text.innerHTML="▲";else text.innerHTML="▼";
  }
</script>
</head>
<body onload="splitAddress()">
<p>&nbsp;</p>
<h1>Japt</h1>
<div id="docs">
<h1>Japt Docs</h1>
<p><strong>Japt</strong> is a shortened version of <strong>Ja</strong>vaScri<strong>pt</strong>.

<h2>Syntax <a href="#" id="toggle-syntax" onclick="toggleTab('syntax')" style="color:#961;text-decoration:none">▼</a></h2>
<div id="syntax" style="display:none">
<h3>Parentheses</h3>
<p>`)` transpiles to `))`.</p>
<p>`&nbsp;` transpiles to `)`.</p>
<p>Parens left out at `;[]{}` or at the end of the program are auto-inserted.

<h3>Variables & Functions</h3>
<p>`A-Z` are pre-defined variables.</p>
<p>`a-z` are various functions, and transpile to `.a(`.</p>
<p>`ABC{` starts an anonymous function with parameters `A`, `B`, and `C`. Equivalent to `function(A,B,C){`</p>

<h3>Shortcuts</h3>
<p>`'a` transpiles to `"a"`.</p>
<p>`#a` transpiles to `97`, the char-code of `a`.</p>

<h3>Strings</h3>
<p>`"abc{U}xyz"` transpiles to<br>`"abc"+(U)+"xyz"`.</p>
<p>`U?"abc:xyz"` transpiles to<br>`U?"abc":"xyz"`.</p>
<p>`Oc"text"` compresses the text.</p>
<p>`Od"text"` decompresses the text.</p>
<p>`` `text` `` also decompresses the text.</p>
<h3>Miscellaneous</h3>
<p>`$...$` is evaluated as pure JS.</p>
<p>Any of ``"`$`` left out at the end of the program is auto-inserted.</p>
</div>

<h2>Variables <a href="#" id="toggle-variables" onclick="toggleTab('variables')" style="color:#961;text-decoration:none">▼</a></h2>
<div id="variables" style="display:none">
<table>
  <tr><td><b>Var</b></td><td><b>Value</b></td></tr>
  <tr><td>A</td><td>10</td></tr>
  <tr><td>B</td><td>11</td></tr>
  <tr><td>C</td><td>12</td></tr>
  <tr><td>D</td><td>13</td></tr>
  <tr><td>E</td><td>14</td></tr>
  <tr><td>F</td><td>15</td></tr>
  <tr><td>G</td><td>16</td></tr>
  <tr><td>H</td><td>32</td></tr>
  <tr><td>I</td><td>64</td></tr>
  <tr><td>J</td><td>-1</td></tr>
  <tr><td>K</td><td>Date</td></tr>
  <tr><td>L</td><td>100</td></tr>
  <tr><td>M</td><td>Math</td></tr>
  <tr><td>N</td><td>input</td></tr>
  <tr><td>O</td><td>shoco</td></tr>
  <tr><td>P</td><td>""</td></tr>
  <tr><td>Q</td><td>"\""</td></tr>
  <tr><td>R</td><td>"\n"</td></tr>
  <tr><td>S</td><td>"&nbsp;"</td></tr>
  <tr><td>T</td><td>0</td></tr>
  <tr><td>UVWXYZ</td><td>...N</td></tr>
</table>
</div>

<h2>String Functions <a href="#" id="toggle-string-funcs" onclick="toggleTab('string-funcs')" style="color:#961;text-decoration:none">▼</a></h2>
<div id="string-funcs" style="display:none">
<h3>`b(s)`</h3>
<p>Returns the index of `s` in `this`.</p>
<h3>`c(n=0)`</h3>
<p>Returns the char-code at index `n` in `this`.</p>
<h3>`d(s)`</h3>
<p>Replaces `x` with `y` in `this` for each pair of chars `xy` in `s`.</p>
<h3>`d(s,s,...)`</h3>
<p>Replaces `x` with `y` in `this` for each pair of args `x,y`.</p>
<h3>`e(r/s,s="")`</h3>
<p>Recursively replaces `r/s` with `s` in `this`.</p>
<h3>`f(r/s)`</h3>
<p>Returns `this.match(r/s)`.</p>
<h3>`g(n)`</h3>
<p>Returns the char at index `n` in `this`.</p>
<h3>`h(n,s)`</h3>
<p>Sets the char at index `n` in `this` to `s`.</p>
<h3>`i(n,s)`</h3>
<p>Inserts `s` at index `n` into `this`.</p>
<h3>`j(n,n)`</h3>
<p>Removes `n₁` chars from index `n₂` in `this`.</p>
<h3>`k(r)`</h3>
<p>Replaces `r` with `""` in `this`.</p>
<h3>`k(s,s="")`</h3>
<p>Replace `RegExp(s)` in `this`.</p>
<h3>`l()`</h3>
<p>Returns the length of `this`.</p>
<h3>`m(f,s="")`</h3>
<p>Splits `this` with `s`, maps each item by `f`, then rejoins with `s`.</p>
<h3>`n(n)`</h3>
<p>Returns `parseInt(this,n)`.</p>
<h3>`p(n)`</h3>
<p>Returns `this` repeated `n` times.</p>
<h3>`q(s="")`</h3>
<p>Returns `this` split with `s`.</p>
<h3>`r(r,s)`</h3>
<p>Replaces `r` with `s` in `this`.</p>
<h3>`r(s,s,s="g")`</h3>
<p>Replaces `RegExp(s₁,s₃)` with `s₂` in `this`.</p>
<h3>`s(n,n?)`</h3>
<p>Returns `this.slice(n₁,n₂)`.</p>
<h3>`t(n,n?)`</h3>
<p>Returns `this.substr(n₁,n₂)`.</p>
<h3>`u()`</h3>
<p>Returns `this.toUpperCase()`.</p>
<h3>`v()`</h3>
<p>Returns `this.toLowerCase()`.</p>
<h3>`w()`</h3>
<p>Returns `this.reverse()`.</p>
</div>

<h2>Array Functions <a href="#" id="toggle-array-funcs" onclick="toggleTab('array-funcs')" style="color:#961;text-decoration:none">▼</a></h2>
<div id="array-funcs" style="display:none">
<h3>`b(a)`</h3>
<p>Returns the index of `a` in `this`.</p>
<h3>`c(a)`</h3>
<p>Returns the last index of `a` in `this`.</p>
<h3>`d(f)`</h3>
<p>Maps each item in `this` through `f`, then returns `true` if any are truthy, and `false` otherwise.</p>
<h3>`e(f)`</h3>
<p>Maps each item in `this` through `f`, then returns `true` if all are truthy, and `false` otherwise.</p>
<h3>`f(f)`</h3>
<p>Selects the items in `this` that return truthily to `f`.</p>
<h3>`g(n)`</h3>
<p>Returns the item at index `n` in `this`.</p>
<h3>`h(n,a)`</h3>
<p>Sets the item at index `n` in `this` to `a`.</p>
<h3>`i(n,a)`</h3>
<p>Inserts `a` at index `n` into `this`.</p>
<h3>`j(n,n)`</h3>
<p>Removes `n₁` items from index `n₂` in `this`.</p>
<h3>`k(a)`</h3>
<p>Removes `a` from `this`.</p>
<h3>`l()`</h3>
<p>Returns the length of `this`.</p>
<h3>`m(f)`</h3>
<p>Maps each item in `this` through `f`.</p>
<h3>`n(f)`</h3>
<p>Sorts `this` by passing each pair of items through `f`. If `f(x,y)<0`, `x` is sorted to the left; if `f(x,y)>0`, `y` is sorted to the left.</p>
<h3>`o()`</h3>
<p>Removes the last item in `this` and returns it.</p>
<h3>`p(a)`</h3>
<p>Pushes `a` to `this` and returns `this.length`.</p>
<h3>`q(s="")`</h3>
<p>Returns `this` joined with `s`.</p>
<h3>`r(f,a?)`</h3>
<p>Reduces `this` with `f`. If `a` is specified, the initial value is set to `a`.</p>
<h3>`s(n,n?)`</h3>
<p>Returns `this.slice(n₁,n₂)`.</p>
<h3>`t(n,n?)`</h3>
<p>Returns `this.slice(n₁,n₁+n₂)`.</p>
<h3>`u(a)`</h3>
<p>Adds `a` to the beginning of `this`.</p>
<h3>`v()`</h3>
<p>Removes the first item of `this` and returns it.</p>
<h3>`w()`</h3>
<p>Returns `this.reverse()`.</p>
<h3>`x()`</h3>
<p>Returns `this` reduced with `+`. If all items are numbers, this sums them.</p>
<h3>`y()`</h3>
<p>If `this` is a 2D array, or an array of strings, transposes rows with columns.</p>
<h3>`z(n=1)`</h3>
<p>If `this` is a 2D array, or an array of strings, rotates `this` by `n*90` degrees clockwise.</p>
</div>

<h2>Number Functions <a href="#" id="toggle-number-funcs" onclick="toggleTab('number-funcs')" style="color:#961;text-decoration:none">▼</a></h2>
<div id="number-funcs" style="display:none">
<h3>`a()`</h3>
<p>Returns the absolute value of `this`.</p>
<h3>`b(n,n)`</h3>
<p>Returns `this` bounded with min `n₁` and max `n₂`.</p>
<h3>`c()`</h3>
<p>Returns `this` rounded up to the nearest integer.</p>
<h3>`d()`</h3>
<p>Returns the char at code-point `this`.</p>
<h3>`e(n)`</h3>
<p>Returns `this*Math.pow(10,n)`.</p>
<h3>`f()`</h3>
<p>Returns `this` rounded down to the nearest integer.</p>
<h3>`g(n)`</h3>
<p>Returns the sign of `this`; `-1` for negative values, `1` for positive, `0` for `0`, and `NaN` for `NaN`.</p>
<h3>`j()`</h3>
<p>Returns `true` if `this` is prime; `false` otherwise.</p>
<h3>`k()`</h3>
<p>Returns `this` as an array.</p>
<h3>`l()`</h3>
<p>Returns the factorial of `this`.</p>
<h3>`m(n)`</h3>
<p>Returns the smaller of `this` and `n`.</p>
<h3>`n(n)`</h3>
<p>Returns `-this`.</p>
<h3>`o(n,n=1)`</h3>
<p>Returns an array of all numbers in the range `[this,n₁)`, generated by starting at `this` and repeatedly adding `n₂`.</p>
<h3>`p(n)`</h3>
<p>Returns `this` to the `n`th power.</p>
<h3>`q()`</h3>
<p>Returns the square root of `this`.</p>
<h3>`r()`</h3>
<p>Returns `this` rounded to the nearest integer.</p>
<h3>`s(n=10)`</h3>
<p>Returns `this` converted to a base-`n` string.</p>
<h3>`u()`</h3>
<p>Returns `1` if `this` is odd; `0` otherwise.</p>
<h3>`v()`</h3>
<p>Returns `1` if `this` is even; `0` otherwise.</p>
<h3>`w()`</h3>
<p>Returns the larger of `this` and `n`.</p>
</div>

<h2>Examples <a href="#" id="toggle-examples" onclick="toggleTab('examples')" style="color:#961;text-decoration:none">▼</a></h2>
<div id="examples" style="display:none">
<p><a href="#" onclick="document.getElementById('code').value='&quot;Hello, World!'">"Hello, World!"</a></p>
<p><a href="#" onclick="document.getElementById('code').value=shoco.c('`Hello, World!')">"Hello, World!" 2</a></p>
<p><a href="#" onclick="document.getElementById('code').value='N'">`cat`</a></p>
<p><a href="#" onclick="document.getElementById('code').value='1o#e m@&quot;FizzBuzz&quot;sX%3&&4,X%5?4:8 ||X}) qR'">FizzBuzz</a></p>
</div>
</div>

<div id="pad-left"></div>
Code:<a style="margin-right:300px">&nbsp;</a>JS code:
<textarea id="code" title="code" rows="8" onkeypress="setTimeout(function(){document.getElementById('js-code').value=transpile(document.getElementById('code').value)},10)">[U,V*Wg0 ,Wg1]qS</textarea>
<textarea id="js-code" rows="8" readonly>[U,V*W.g(0),W.g(1)].q(S)</textarea>
<br>Input:<a style="margin-right:300px">&nbsp;</a>Output:
<br>
<textarea id="input" rows="6">"abc" 13 [9 "zyx"]</textarea><textarea id="output" rows="6" readonly></textarea>
<p>Timeout: (doesn't work)
  <input id="timeout" type="checkbox" checked="checked">&nbsp;
  <br>
  <br>
  <input id="run" type="button" value="Run" onclick="run()">
  <input id="stop" type="button" value="Stop" onclick="interrupt()" disabled="disabled">
  <input id="clear" type="button" value="Clear" onclick="clear_output()">
  <br>
  <br>
  <input id="permalink" type="button" value="Permalink" onclick="getURL()">
  <br>
  <br>
  Upload an ISO_8859-encoded file:&nbsp;
  <input id="text-file" type="file" onsubmit="document.getElementById('code').value=this.value" />
  <input id="submit" type="button" value="Submit" onclick="var fr=new FileReader();fr.onload=function(){document.getElementById('code').value=fr.result};fr.readAsBinaryString(document.getElementById('text-file').files[0])"></button>
  <br>
  <span id="stderr" style="color:red"></span>
</p>
</body>
</html>
